<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>It's Python Somewhere in the World</title>

		<link rel="stylesheet" href="reveal/reveal.css">
        <link rel="stylesheet" href="reveal/simple.css">
        <link rel="stylesheet" href="highlight/github.min.css">

        <style>
			.muted {
				color: #666666 !important;
			}

			h1, h2, h3, h4 {
				font-weight: bold !important;
			}
			
			h1 {
				margin-bottom: 40px !important;
			}

			h2 {
				font-size: 2em !important;
			}

			h2 + pre {
				margin-top: 50px !important;
			}

			p {
				font-size: 1.3em !important;
			}

			code {
				font-size: 2em !important;
				line-height: 1.1em !important;
				max-height: none !important;
				overflow: hidden !important;
				padding: 20px !important;
			}

			.important {
				color: red;
			}
        </style>
    </head>
    <body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>It's Python Somewhere in the World</h1>
					<h3 class="muted">Datetime Localization in Python</h3>
				</section>

				<section>
					<h1>Me</h1>

					<p>Jared Morse - <span class="muted">github.com/jarcoal</span></p>
					<p>Appointlet - <span class="muted">appointlet.com</span></p>
				</section>

				<section>
					<h1>Agenda</h1>

					<ol>
						<li class="fragment"><p>datetime - <span class="muted">date, time, datetime, strftime</span></p></li>
						<li class="fragment"><p>tzinfo - <span class="muted">From naive to aware</span></p></li>
						<li class="fragment"><p>pytz - <span class="muted">Olson database in Python</span></p></li>
						<li class="fragment"><p>Django - <span class="muted">USE_TZ, django.utils, templates</span></p></li>
					</ol>
				</section>

				<section>
					<h2>Before we begin...</h2>
				</section>

				<section>
					<h1>Why Localize?</h1>
				</section>

				<section>
					<h2>[map of world]</h2>
				</section>

				<section>
					<h1>datetime</h1>
					<p class="muted">from datetime import date, time, datetime</p>
				</section>

				<section>
					<h2>date<span class="muted">(year, month, day)</span></h2>
				</section>

				<section>
						<pre><code data-trim>
>>> from datetime import date

>>> d = date(2013, 7, 9)

>>> d.year
2013
>>> d.month
7
>>> d.day
9
						</code></pre>
				</section>

				<section>
					<h2>Comparisons</h2>

					<pre><code data-trim>
>>> today = date(2013, 7, 9)
>>> yesterday = date(2013, 7, 8)

>>> today > yesterday
True
					</code></pre>
				</section>

				<section>
					<h2>Equality Checking</h2>

					<pre><code data-trim>
>>> today = date(2013, 7, 9)
>>> also_today = date(2013, 7, 9)

>>> today == also_today
True
					</code></pre>
				</section>

				<section>
					<h2>Output Formatting</h2>

					<pre><code data-trim>
>>> today = date(2013, 7, 9)

>>> today.strftime('%Y-%m-%d')
'2013-07-09'

>>> today.strftime('%A')
'Tuesday'
					</code></pre>
				</section>

				<section>
					<h2>Formatting Definitions</h2>
					<a href="http://docs.python.org/2/library/datetime.html">http://docs.python.org/2/library/datetime.html</a>
					<p style="margin-top: 25px;">Bookmark it!</p>
				</section>

				<section>
					<h2>time<span class="muted">(hour, min, sec, microsec)</span></h2>
				</section>

				<section>
						<pre><code data-trim>
>>> from datetime import time

>>> t = time(18, 30)

>>> t.hour
18
>>> t.minute
30
>>> t.second
0
						</code></pre>
				</section>

				<section>
					<h2>Comparisons</h2>
					<p>Just like date()</p>

					<pre><code data-trim>
>>> time(18, 0) > time(19, 0)
False
					</code></pre>
				</section>

				<section>
					<h2>Output Formatting</h2>
					<p>Also, just like date()</p>

					<pre><code data-trim>
>>> t = time(18, 30)

>>> t.strftime('%H:%M')
'18:30'

>>> t.strftime('%I:%M %p')
'06:30 PM'
					</code></pre>
				</section>

				<section>
					<h2>Putting it together...</h2>
				</section>

				<section>
					<h2>datetime<span class="muted">(year, month, day, hour, min, sec, microsec)</span></h2>
				</section>

				<section>
					<h2>Both date() and time()</h2>
					<p>a specific moment</p>
				</section>

				<section>
					<pre><code data-trim>
>>> from datetime import datetime

>>> dt = datetime.now()

>>> dt.year
2013
>>> dt.month
7
>>> dt.day
9
>>> dt.hour
6

...
					</code></pre>
				</section>

				<section>
					<h2>A specific moment <span class="fragment important" data-fragment-index="1">*</span></h2>
					<strong class="fragment important" data-fragment-index="1">* kinda</strong>
				</section>

				<section>
					<h2>datetime<span class="muted">(2013, 7, 9, 18, 30)</span></h2>
					<p>6:30pm, July 9th 2013</p>
				</section>

				<section>
					<h2 class="muted">In...</h2>
					<h2 class="fragment">Portland?</h2>
					<h2 class="fragment">NYC?</h2>
					<h2 class="fragment">Paris?</h2>
				</section>

				<section>
					<h2>Where did it occur?</h2>
				</section>

				<section>
					<h2>datetime<span class="muted">(year, month, day, hour, min, sec, microsec)</span></h2>
				</section>

				<section>
					<h2>datetime<span class="muted">(year, month, day, hour, min, sec, microsec, <span class="important">tzinfo</span>)</span></h2>
				</section>

				<section>
					<h2>Let's take a quick detour...</h2>
				</section>

				<section>
					<h2>What makes up a time zone?</h2>

					<ul>
						<li class="fragment">daylight savings (not always, sorry AZ)</li>
						<li class="fragment">an offset from <del>GMT</del> UTC</li>
					</ul>
				</section>

				<section>
					<h2>UTC?</h2>

					<ul>
						<li class="fragment">Coordinated Universal Time</li>
						<li class="fragment">formerly GMT</li>
						<li class="fragment">no daylight savings, ever</li>
						<li class="fragment">all other zones are offset from this</li>
					</ul>
				</section>

				<section>
					<h2>Now we're ready for tzinfo</h2>
				</section>

				<section>
					<h1>tzinfo</h1>
					<h3 class="muted">From Naive to Aware</h3>
				</section>

				<section>
					<h2>Where do they come from?</h2>
				</section>

				<section>
					<h2>You</h2>
					<p>The stdlib does not define any time zones</p>
				</section>

				<section>
					<h2>How do I build one?</h2>
				</section>

				<section>
					<h2>tzinfo is an interface</h2>
					<p>You must implement it</p>
				</section>

				<section>
					<h2>We know tzinfo must:</h2>

					<ul>
						<li class="fragment">define an offset from UTC</li>
						<li class="fragment">define an offset for daylight savings (if any)</li>
					</ul>
				</section>

				<section>
					<pre><code data-trim>						
from datetime import tzinfo

class MyTimeZone(tzinfo):

  def utcoffset(self, dt):
    "What's the offset from UTC?"

  def dst(self, dt):
    "Is DST in effect?"
					</code></pre>
				</section>

				<section>
					<pre><code data-trim>
>>> tz = MyTimeZone()
>>> datetime(..., tzinfo=tz)
					</code></pre>
				</section>

				<section>
					<h2>Comparisons</h2>
					<pre><code data-trim>
>>> tz = MyTimeZone()
>>> datetime(..., tzinfo=tz)
					</code></pre>
				</section>

				<section>
					<h2>Equality &amp; Comparisons</h2>
					<pre><code data-trim>
>>> pdx = datetime(2013, 7, 9, 18)
>>> nyc = datetime(2013, 7, 9, 18)
>>> pdx == nyc
True

>>> pdx = pdx.replace(tzinfo=pst)
>>> nyc = nyc.replace(tzinfo=est)
>>> pdx == nyc
False
>>> pdx > nyc
True
					</code></pre>
				</section>

				<section>
					<h2>Can't someone else build these?</h2>
				</section>

				<section>
					<h1>pytz</h1>
					<h3 class="muted">Olson database in Python</h3>
					<a href="http://pytz.sourceforge.net/">http://pytz.sourceforge.net/</a>
				</section>

				<section>
					<h2>pip install pytz</h2>
				</section>

				<section>
					<h2>Olson database</h2>
					<p>America/Los_Angeles, Europe/Paris, etc</p>
				</section>

				<section>
					<h2>Easy tzinfo</h2>

					<pre><code data-trim>
>>> from pytz import timezone

>>> pst = 'America/Los_Angeles'
>>> pst_tz = timezone(pst)
					</code></pre>

					<p class="muted">`pst_tz` implements tzinfo</p>
				</section>

				<section>
					<h2>Localize</h2>

					<pre><code data-trim>
>>> pdx = pst_tz.localize(now())
					</code></pre>

					<p class="muted">`pdx` is now in PST zone</p>
				</section>

				<section>
					<h2>Also useful...</h2>
				</section>

				<section>
					<h2>Big ol' list of zones</h2>
					<pre><code data-trim>
>>> import pytz
>>> pytz.common_timezones
['Africa/Abidjan', 'Africa/Accra',
'Africa/Addis_Ababa', 'Africa/Algiers',
'Africa/Asmara', ...]
					</code></pre>

					<p class="muted">Great for &lt;select&gt; menus</p>
				</section>

				<section>
					<h2>Zones by country</h2>

					<pre><code data-trim>
>>> import pytz
>>> pytz.country_timezones['US']
['America/New_York',
'America/Detroit',
'America/Kentucky/Louisville',
'America/Kentucky/Monticello', ...]
					</code></pre>
				</section>
			</div>
		</div>

		<script src="reveal/head.min.js"></script>
		<script src="reveal/reveal.js"></script>

		<script>
			Reveal.initialize({
				transition: 'fade',
				transitionSpeed: 'fast',
				history: true,
				dependencies: [{ src: 'highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }],
			});
		</script>
    </body>
</html>
